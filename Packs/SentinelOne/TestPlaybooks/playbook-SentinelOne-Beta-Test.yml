id: SentinelOne V2 - test
version: -1
name: SentinelOne V2 - test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: ddb07038-1312-448d-80f3-c1c02a0dfe48
    type: start
    task:
      id: ddb07038-1312-448d-80f3-c1c02a0dfe48
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
      - "22"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: 092a2fde-1069-44ed-800c-374dd1dad9f8
    type: regular
    task:
      id: 092a2fde-1069-44ed-800c-374dd1dad9f8
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
      - "3"
      - "4"
      - "7"
      - "12"
      - "32"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: b5712eae-e134-4325-81a1-2a30f8d34dad
    type: regular
    task:
      id: b5712eae-e134-4325-81a1-2a30f8d34dad
      version: -1
      name: Get Threats
      description: Get threats using a variety of filters.
      script: '|||sentinelone-get-threats'
      type: regular
      iscommand: true
      brand: ""
    scriptarguments:
      classifications: {}
      content_hash: {}
      created_after: {}
      created_before: {}
      created_from: {}
      created_until: {}
      display_name: {}
      limit: {}
      mitigation_status: {}
      query: {}
      rank: {}
      resolved: {}
      threat_ids: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: fc5fe210-ca60-4ca9-8073-bfd6b688d72f
    type: regular
    task:
      id: fc5fe210-ca60-4ca9-8073-bfd6b688d72f
      version: -1
      name: Get Activities
      description: Get a list of activities.
      script: '|||sentinelone-get-activities'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      activities_ids: {}
      activity_types: {}
      agent_ids: {}
      created_after: {}
      created_before: {}
      created_between: {}
      created_from: {}
      created_until: {}
      group_ids: {}
      include_hidden: {}
      limit: {}
      threats_ids: {}
      user_emails: {}
      user_ids: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: f6316e23-0270-4323-880d-93da6b66b8b0
    type: regular
    task:
      id: f6316e23-0270-4323-880d-93da6b66b8b0
      version: -1
      name: Get All agents
      description: List all agents matching the input filter.
      script: '|||sentinelone-list-agents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      computer_name: {}
      created_at: {}
      min_active_threats: {}
      os_type: {}
      scan_status: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "5":
    id: "5"
    taskid: d6eb3f99-c40f-4d2b-8449-33f5570bbe07
    type: regular
    task:
      id: d6eb3f99-c40f-4d2b-8449-33f5570bbe07
      version: -1
      name: Get Agent
      description: Get details of an agent by its ID.
      script: '|||sentinelone-get-agent'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      agent_id:
        simple: "657613730168123595"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 5822fbe2-a1ba-4850-8d1e-e1e0de0e29e9
    type: regular
    task:
      id: 5822fbe2-a1ba-4850-8d1e-e1e0de0e29e9
      version: -1
      name: Get Agent Processess
      description: Retrieve running processes for a specific agent.
      script: '|||sentinelone-agent-processes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      agents_ids:
        simple: "657613730168123595"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: 9848cdae-cbb2-4113-8478-148b687a34e2
    type: regular
    task:
      id: 9848cdae-cbb2-4113-8478-148b687a34e2
      version: -1
      name: Get all groups
      description: Gets the group data.
      script: '|||sentinelone-get-groups'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      group_id: {}
      group_ids: {}
      group_type: {}
      is_default: {}
      limit: {}
      name: {}
      query: {}
      rank: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: 8360d0ca-1167-4cb0-8438-9b8b87bc7f11
    type: regular
    task:
      id: 8360d0ca-1167-4cb0-8438-9b8b87bc7f11
      version: -1
      name: Get threat summary
      description: Get dashboard threat summary.
      script: '|||sentinelone-threat-summary'
      type: regular
      iscommand: true
      brand: ""
    scriptarguments:
      group_ids:
        simple: ${SentinelOne.Group.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: a9e14b07-cc52-4634-86af-ac9a4cf1339d
    type: regular
    task:
      id: a9e14b07-cc52-4634-86af-ac9a4cf1339d
      version: -1
      name: Disconnect agent to network
      description: Disconnect agents from network
      script: '|||sentinelone-disconnect-agent'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      agent_id:
        simple: ${SentinelOne.Agent.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: 6e4a8f69-d0ba-4064-8726-068564ab1297
    type: regular
    task:
      id: 6e4a8f69-d0ba-4064-8726-068564ab1297
      version: -1
      name: Broadcast Message
      description: Broadcasts a message to all agents matching the input filter.
      script: '|||sentinelone-broadcast-message'
      type: regular
      iscommand: true
      brand: ""
    scriptarguments:
      active_agent: {}
      agent_id:
        simple: "657613730168123595"
      domain: {}
      group_id: {}
      message:
        simple: Hey There, just checking
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "13":
    id: "13"
    taskid: 375ba8b8-7c1f-428c-8c14-5ee44681cc2f
    type: regular
    task:
      id: 375ba8b8-7c1f-428c-8c14-5ee44681cc2f
      version: -1
      name: Create Query ID
      description: Start a Deep Visibility Query and get the queryId, use queryId
        for all other APIs such as Get All Events
      script: '|||sentinelone-create-query'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      from_date:
        complex:
          root: TimeNow
          transformers:
          - operator: ModifyDateTime
            args:
              variation:
                value:
                  simple: 90 days ago
      query:
        simple: AgentName Is Not Empty
      to_date:
        complex:
          root: TimeNow
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "14":
    id: "14"
    taskid: 2fe3facd-700d-45fc-8e5a-c649c32d1d69
    type: regular
    task:
      id: 2fe3facd-700d-45fc-8e5a-c649c32d1d69
      version: -1
      name: Get events
      description: Get all Deep Visibility events from query
      script: '|||sentinelone-get-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      limit:
        simple: "10"
      query_id:
        simple: ${SentinelOne.Query.QueryID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: 798ac728-7b58-4a60-89e3-1a00f8c49527
    type: regular
    task:
      id: 798ac728-7b58-4a60-89e3-1a00f8c49527
      version: -1
      name: Get processes
      description: Get Deep Visibility events from query by event type - process
      script: '|||sentinelone-get-processes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      limit: {}
      query_id:
        simple: ${SentinelOne.Query.QueryID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "17":
    id: "17"
    taskid: a52f3530-1f86-4bea-837f-496aef5b1440
    type: regular
    task:
      id: a52f3530-1f86-4bea-837f-496aef5b1440
      version: -1
      name: Get agent activities
      description: Returns a list of activities.
      script: '|||sentinelone-get-activities'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      activities_ids: {}
      activity_types: {}
      agent_ids:
        complex:
          root: SentinelOne
          accessor: Activity.AgentID
          transformers:
          - operator: GetFirstObject
      created_after: {}
      created_before: {}
      created_between: {}
      created_from: {}
      created_until: {}
      group_ids: {}
      include_hidden: {}
      limit:
        simple: "10"
      threats_ids: {}
      user_emails: {}
      user_ids: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "18":
    id: "18"
    taskid: e1e2fb56-78e3-4cdd-813a-9796db7e4dbb
    type: condition
    task:
      id: e1e2fb56-78e3-4cdd-813a-9796db7e4dbb
      version: -1
      name: Verify Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Event.ProcessID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Event.ProcessName
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "19":
    id: "19"
    taskid: 6ab0c8a8-02b3-4177-81dd-dc51fe134103
    type: title
    task:
      id: 6ab0c8a8-02b3-4177-81dd-dc51fe134103
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "20":
    id: "20"
    taskid: ed29a597-4e19-4706-8a50-f27c279ab298
    type: condition
    task:
      id: ed29a597-4e19-4706-8a50-f27c279ab298
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Event.ProcessID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Event.ProcessName
            iscontext: true
    view: |-
      {
        "position": {
          "x": 807.5,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "21":
    id: "21"
    taskid: 9a991b87-063f-4887-8460-1aeded6b0bbb
    type: condition
    task:
      id: 9a991b87-063f-4887-8460-1aeded6b0bbb
      version: -1
      name: Verify outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Activity.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Activity.ActivityType
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1565,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "22":
    id: "22"
    taskid: ba6149a3-4a32-4eac-8904-4a682df82589
    type: regular
    task:
      id: ba6149a3-4a32-4eac-8904-4a682df82589
      version: -1
      name: Fetch Incidents
      description: Execute FetchIncident for a given instance
      scriptName: FetchFromInstance
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      add_to_context: {}
      brand_name:
        simple: SentinelOne V2
      error_msg_in_incident: {}
      expect_data: {}
      instance_name: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "23":
    id: "23"
    taskid: a02f1580-062f-4ac1-840a-9592bd868a23
    type: regular
    task:
      id: a02f1580-062f-4ac1-840a-9592bd868a23
      version: -1
      name: Get agent
      description: Returns details of an agent, by agent ID.
      script: '|||sentinelone-get-agent'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      agent_id:
        simple: ${SentinelOne.Agent.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "24":
    id: "24"
    taskid: 43dda8f0-8f8f-42cc-8196-4f0509a7f2c9
    type: condition
    task:
      id: 43dda8f0-8f8f-42cc-8196-4f0509a7f2c9
      version: -1
      name: 'Is the agent disconnected? '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: SentinelOne.Agent.NetworkStatus
            iscontext: true
          right:
            value:
              simple: disconnecting
        - operator: isEqualString
          left:
            value:
              simple: SentinelOne.Agent.NetworkStatus
            iscontext: true
          right:
            value:
              simple: disconnected
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "25":
    id: "25"
    taskid: 5cc2fc54-a0b0-4583-8c40-9d58d2a5196b
    type: regular
    task:
      id: 5cc2fc54-a0b0-4583-8c40-9d58d2a5196b
      version: -1
      name: Connect agent to network
      description: Connects agents to network.
      script: '|||sentinelone-connect-agent'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      agent_id:
        simple: ${SentinelOne.Agent.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "26":
    id: "26"
    taskid: 993f9294-20b2-49b1-872b-a1a1c4846da4
    type: regular
    task:
      id: 993f9294-20b2-49b1-872b-a1a1c4846da4
      version: -1
      name: Get agent
      description: Returns details of an agent, by agent ID.
      script: '|||sentinelone-get-agent'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      agent_id:
        simple: ${SentinelOne.Agent.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "27":
    id: "27"
    taskid: e8bd0fec-8778-4f5e-80cd-8f8f5274db40
    type: condition
    task:
      id: e8bd0fec-8778-4f5e-80cd-8f8f5274db40
      version: -1
      name: 'Is the agent reconnect? '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: SentinelOne.Agent.NetworkStatus
            iscontext: true
          right:
            value:
              simple: connecting
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "28":
    id: "28"
    taskid: 873d7672-aac8-4162-82a7-0b384a34b517
    type: title
    task:
      id: 873d7672-aac8-4162-82a7-0b384a34b517
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "29":
    id: "29"
    taskid: 5af56d1d-e117-463b-8c4c-ac65ac92ac02
    type: condition
    task:
      id: 5af56d1d-e117-463b-8c4c-ac65ac92ac02
      version: -1
      name: Verify Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Query.QueryID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "30":
    id: "30"
    taskid: 585997bb-faea-463a-8242-f2e39fdc9e9d
    type: regular
    task:
      id: 585997bb-faea-463a-8242-f2e39fdc9e9d
      version: -1
      name: Wait
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
      - "15"
    scriptarguments:
      seconds:
        simple: "30"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "31":
    id: "31"
    taskid: 24a5787e-b483-4226-879f-eae052b16c71
    type: regular
    task:
      id: 24a5787e-b483-4226-879f-eae052b16c71
      version: -1
      name: Wait
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      seconds:
        simple: "2"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1995,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: 80b7b836-e510-45ad-8158-f1047cd6a7b0
    type: regular
    task:
      id: 80b7b836-e510-45ad-8158-f1047cd6a7b0
      version: -1
      name: Set Date
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      contextKey: {}
      date: {}
      dateFormat:
        simple: ISO
      daysAgo: {}
      hoursAgo: {}
      minutesAgo: {}
      monthsAgo: {}
      yearsAgo: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2135,
        "width": 2325,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
