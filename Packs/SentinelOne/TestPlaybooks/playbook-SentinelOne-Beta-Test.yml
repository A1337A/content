id: SentinelOne V3 - test
version: -1
name: SentinelOne V3 - test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 7025e2ab-ea9c-42bd-8307-6fb14645ed74
    type: start
    task:
      id: 7025e2ab-ea9c-42bd-8307-6fb14645ed74
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
      - "22"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1555,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "1":
    id: "1"
    taskid: c7b33ece-94bd-4e71-8223-8fb4ac97ee48
    type: regular
    task:
      id: c7b33ece-94bd-4e71-8223-8fb4ac97ee48
      version: -1
      name: Delete Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
      - "4"
      - "7"
      - "32"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1125,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "2":
    id: "2"
    taskid: 0eeb5cd8-1791-4e8f-85b1-850d199ed320
    type: regular
    task:
      id: 0eeb5cd8-1791-4e8f-85b1-850d199ed320
      version: -1
      name: Get Threats
      description: Get threats using a variety of filters.
      script: '|||sentinelone-get-threats'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      classifications: {}
      content_hash: {}
      created_after: {}
      created_before: {}
      created_from: {}
      created_until: {}
      display_name: {}
      limit: {}
      mitigation_status: {}
      query: {}
      rank: {}
      resolved:
        simple: "true"
      threat_ids: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 1daa8a1d-ffcf-4aa0-8a30-6a0ddd587afc
    type: regular
    task:
      id: 1daa8a1d-ffcf-4aa0-8a30-6a0ddd587afc
      version: -1
      name: Get Activities
      description: Get a list of activities.
      script: '|||sentinelone-get-activities'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      activities_ids: {}
      activity_types: {}
      agent_ids: {}
      created_after: {}
      created_before: {}
      created_between: {}
      created_from: {}
      created_until: {}
      group_ids: {}
      include_hidden: {}
      limit: {}
      threats_ids: {}
      user_emails: {}
      user_ids: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "4":
    id: "4"
    taskid: 0750389a-1894-4c9b-8128-f51d11e2dd65
    type: regular
    task:
      id: 0750389a-1894-4c9b-8128-f51d11e2dd65
      version: -1
      name: Get All agents
      description: List all agents matching the input filter.
      script: '|||sentinelone-list-agents'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      computer_name: {}
      created_at: {}
      min_active_threats: {}
      os_type: {}
      scan_status: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "5":
    id: "5"
    taskid: 13919fda-ed70-4b9d-8af9-2fc1ae29c85d
    type: regular
    task:
      id: 13919fda-ed70-4b9d-8af9-2fc1ae29c85d
      version: -1
      name: Get Agent
      description: Get details of an agent by its ID.
      script: '|||sentinelone-get-agent'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      agent_id:
        simple: "657613730168123595"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "6":
    id: "6"
    taskid: fedd6c36-5a5b-4d09-8fce-29e36ab1e7a2
    type: regular
    task:
      id: fedd6c36-5a5b-4d09-8fce-29e36ab1e7a2
      version: -1
      name: Get Agent Processess
      description: Retrieve running processes for a specific agent.
      script: '|||sentinelone-agent-processes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      agents_ids:
        simple: "657613730168123595"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "7":
    id: "7"
    taskid: 611df880-cf57-4a65-8a23-8dcb800175a1
    type: regular
    task:
      id: 611df880-cf57-4a65-8a23-8dcb800175a1
      version: -1
      name: Get all groups
      description: Gets the group data.
      script: '|||sentinelone-get-groups'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      group_id: {}
      group_ids: {}
      group_type: {}
      is_default: {}
      limit: {}
      name: {}
      query: {}
      rank: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "8":
    id: "8"
    taskid: 19829689-5b95-439f-8f48-176ca184d64e
    type: regular
    task:
      id: 19829689-5b95-439f-8f48-176ca184d64e
      version: -1
      name: Get threat summary
      description: Get dashboard threat summary.
      script: '|||sentinelone-threat-summary'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      group_ids:
        simple: ${SentinelOne.Group.id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "10":
    id: "10"
    taskid: beb93656-3de2-4fd2-8f3e-a007d78cbf69
    type: regular
    task:
      id: beb93656-3de2-4fd2-8f3e-a007d78cbf69
      version: -1
      name: Disconnect agent to network
      description: Disconnect agents from network
      script: '|||sentinelone-disconnect-agent'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      agent_id:
        simple: ${SentinelOne.Agent.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "12":
    id: "12"
    taskid: 35494f7a-01ea-4f0e-8323-34490c756ef6
    type: regular
    task:
      id: 35494f7a-01ea-4f0e-8323-34490c756ef6
      version: -1
      name: Broadcast Message
      description: Broadcasts a message to all agents matching the input filter.
      script: '|||sentinelone-broadcast-message'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      active_agent: {}
      agent_id:
        simple: "657613730168123595"
      domain: {}
      group_id: {}
      message:
        simple: Hey There, just checking
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "13":
    id: "13"
    taskid: 8a6a4ed7-c25e-4990-83a0-f1a72fe24941
    type: regular
    task:
      id: 8a6a4ed7-c25e-4990-83a0-f1a72fe24941
      version: -1
      name: Create Query ID
      description: Start a Deep Visibility Query and get the queryId, use queryId
        for all other APIs such as Get All Events
      script: '|||sentinelone-create-query'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "29"
    scriptarguments:
      from_date:
        complex:
          root: TimeNow
          transformers:
          - operator: ModifyDateTime
            args:
              variation:
                value:
                  simple: 90 days ago
      query:
        simple: AgentName Is Not Empty
      to_date:
        complex:
          root: TimeNow
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "14":
    id: "14"
    taskid: 346c87c7-2dde-455a-845a-0f0e524dac2a
    type: regular
    task:
      id: 346c87c7-2dde-455a-845a-0f0e524dac2a
      version: -1
      name: Get events
      description: Get all Deep Visibility events from query
      script: '|||sentinelone-get-events'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      limit:
        simple: "10"
      query_id:
        simple: ${SentinelOne.Query.QueryID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "15":
    id: "15"
    taskid: ef421d2b-e619-4678-8434-37123a305b95
    type: regular
    task:
      id: ef421d2b-e619-4678-8434-37123a305b95
      version: -1
      name: Get processes
      description: Get Deep Visibility events from query by event type - process
      script: '|||sentinelone-get-processes'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      limit: {}
      query_id:
        simple: ${SentinelOne.Query.QueryID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "17":
    id: "17"
    taskid: 4fe8f4b2-3464-423d-83c7-ecfa8c31d127
    type: regular
    task:
      id: 4fe8f4b2-3464-423d-83c7-ecfa8c31d127
      version: -1
      name: Get agent activities
      description: Returns a list of activities.
      script: '|||sentinelone-get-activities'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      activities_ids: {}
      activity_types: {}
      agent_ids:
        complex:
          root: SentinelOne
          accessor: Activity.AgentID
          transformers:
          - operator: GetFirstObject
      created_after: {}
      created_before: {}
      created_between: {}
      created_from: {}
      created_until: {}
      group_ids: {}
      include_hidden: {}
      limit:
        simple: "10"
      threats_ids: {}
      user_emails: {}
      user_ids: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "18":
    id: "18"
    taskid: a7095b72-10de-4dcd-80a6-5ba733684732
    type: condition
    task:
      id: a7095b72-10de-4dcd-80a6-5ba733684732
      version: -1
      name: Verify Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Event.ProcessID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Event.ProcessName
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: 3e4c2316-1a15-4133-8e06-59beee2319c1
    type: title
    task:
      id: 3e4c2316-1a15-4133-8e06-59beee2319c1
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "20":
    id: "20"
    taskid: e38e87a6-5674-4f97-8eeb-69c4708bd15a
    type: condition
    task:
      id: e38e87a6-5674-4f97-8eeb-69c4708bd15a
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Event.ProcessID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Event.ProcessName
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "21":
    id: "21"
    taskid: 412dee73-b675-4d09-8a7a-4c96fd1aa3b3
    type: condition
    task:
      id: 412dee73-b675-4d09-8a7a-4c96fd1aa3b3
      version: -1
      name: Verify outputs
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Activity.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Activity.ActivityType
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "22":
    id: "22"
    taskid: 309538a9-1e9e-4685-8bdd-0943c8c7b9aa
    type: regular
    task:
      id: 309538a9-1e9e-4685-8bdd-0943c8c7b9aa
      version: -1
      name: Fetch Incidents
      description: Execute FetchIncident for a given instance
      scriptName: FetchFromInstance
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      add_to_context: {}
      brand_name:
        simple: SentinelOne V3
      error_msg_in_incident: {}
      expect_data: {}
      instance_name: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "23":
    id: "23"
    taskid: 31ddaab4-e9ca-48f7-8e2f-1c9b7ff1aac1
    type: regular
    task:
      id: 31ddaab4-e9ca-48f7-8e2f-1c9b7ff1aac1
      version: -1
      name: Get agent
      description: Returns details of an agent, by agent ID.
      script: '|||sentinelone-get-agent'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      agent_id:
        simple: ${SentinelOne.Agent.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "24":
    id: "24"
    taskid: 522a81dd-0f98-4f79-8a43-ccb9f585f1a1
    type: condition
    task:
      id: 522a81dd-0f98-4f79-8a43-ccb9f585f1a1
      version: -1
      name: 'Is the agent disconnected? '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "25"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: SentinelOne.Agent.NetworkStatus
            iscontext: true
          right:
            value:
              simple: disconnecting
        - operator: isEqualString
          left:
            value:
              simple: SentinelOne.Agent.NetworkStatus
            iscontext: true
          right:
            value:
              simple: disconnected
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "25":
    id: "25"
    taskid: e255f0aa-817c-42eb-896d-a3a6130ec487
    type: regular
    task:
      id: e255f0aa-817c-42eb-896d-a3a6130ec487
      version: -1
      name: Connect agent to network
      description: Connects agents to network.
      script: '|||sentinelone-connect-agent'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      agent_id:
        simple: ${SentinelOne.Agent.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "26":
    id: "26"
    taskid: fbf0e35c-8086-474a-8618-49ae6b8a98b3
    type: regular
    task:
      id: fbf0e35c-8086-474a-8618-49ae6b8a98b3
      version: -1
      name: Get agent
      description: Returns details of an agent, by agent ID.
      script: '|||sentinelone-get-agent'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      agent_id:
        simple: ${SentinelOne.Agent.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "27":
    id: "27"
    taskid: 1d7a50da-ad1f-41f2-8e7e-7877c1f5ad84
    type: condition
    task:
      id: 1d7a50da-ad1f-41f2-8e7e-7877c1f5ad84
      version: -1
      name: 'Is the agent reconnect? '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: SentinelOne.Agent.NetworkStatus
            iscontext: true
          right:
            value:
              simple: connecting
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "28":
    id: "28"
    taskid: 9f449e65-1451-417a-85aa-74c17b8f09e2
    type: title
    task:
      id: 9f449e65-1451-417a-85aa-74c17b8f09e2
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "29":
    id: "29"
    taskid: 69d8efd3-5056-4a54-8400-bf16ef7b7aa2
    type: condition
    task:
      id: 69d8efd3-5056-4a54-8400-bf16ef7b7aa2
      version: -1
      name: Verify Context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "30"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Query.QueryID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "30":
    id: "30"
    taskid: 0c34540d-c869-4e24-8595-abd04d4f1b16
    type: regular
    task:
      id: 0c34540d-c869-4e24-8595-abd04d4f1b16
      version: -1
      name: Wait
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
      - "15"
    scriptarguments:
      seconds:
        simple: "30"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "31":
    id: "31"
    taskid: 53e72ca2-c62d-447c-81d3-48c5e67dc1e8
    type: regular
    task:
      id: 53e72ca2-c62d-447c-81d3-48c5e67dc1e8
      version: -1
      name: Wait
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      seconds:
        simple: "2"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "32":
    id: "32"
    taskid: d7e6778a-09d9-4f7d-85cc-9debb4e6fc67
    type: regular
    task:
      id: d7e6778a-09d9-4f7d-85cc-9debb4e6fc67
      version: -1
      name: Set Date
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      contextKey: {}
      date: {}
      dateFormat:
        simple: ISO
      daysAgo: {}
      hoursAgo: {}
      minutesAgo: {}
      monthsAgo: {}
      yearsAgo: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "33":
    id: "33"
    taskid: e00dac4f-e375-4aca-882b-0117c203b845
    type: regular
    task:
      id: e00dac4f-e375-4aca-882b-0117c203b845
      version: -1
      name: Get all sites
      description: Returns all sites that match the specified criteria.
      script: '|||sentinelone-get-sites'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      account_id: {}
      admin_only: {}
      created_at: {}
      features: {}
      limit: {}
      query: {}
      site_name: {}
      site_type: {}
      state: {}
      suite: {}
      updated_at: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "34":
    id: "34"
    taskid: 5fe43425-f73c-4b26-89be-645f41889c03
    type: regular
    task:
      id: 5fe43425-f73c-4b26-89be-645f41889c03
      version: -1
      name: Get Site
      description: Returns a site, by site ID.
      script: '|||sentinelone-get-site'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      site_id:
        complex:
          root: SentinelOne.Site
          accessor: ID
          transformers:
          - operator: FirstArrayElement
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "35":
    id: "35"
    taskid: 5a026843-8474-4a6e-8f54-7df2e7f39cd8
    type: title
    task:
      id: 5a026843-8474-4a6e-8f54-7df2e7f39cd8
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "36":
    id: "36"
    taskid: e1e7e669-bae8-42df-8d70-9ab9b9d8b21d
    type: condition
    task:
      id: e1e7e669-bae8-42df-8d70-9ab9b9d8b21d
      version: -1
      name: Verify result
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "35"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: SentinelOne.Site.ID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1770,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "37":
    id: "37"
    taskid: 2f0141cd-d554-4ad0-8eca-c23d828922f0
    type: condition
    task:
      id: 2f0141cd-d554-4ad0-8eca-c23d828922f0
      version: -1
      name: Verify Results
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "38"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: SentinelOne.Threat
            iscontext: true
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "38":
    id: "38"
    taskid: ec508da3-b3d0-490d-8c33-636e9e43d85c
    type: title
    task:
      id: ec508da3-b3d0-490d-8c33-636e9e43d85c
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "39":
    id: "39"
    taskid: f8e6d2b1-8719-4eff-81f8-0dd38a5685bb
    type: regular
    task:
      id: f8e6d2b1-8719-4eff-81f8-0dd38a5685bb
      version: -1
      name: Delete Threat from Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all: {}
      index: {}
      key:
        simple: SentinelOne.Threat
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2200,
          "y": 360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2135,
        "width": 2530,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
